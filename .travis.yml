language: c
#computer: gcc
matrix:
  include:
  -  os: linux
    dist: bionic
    sudo: true
  - os: osx
  osx_image: xcode8.3
  
branches:
  only:
    - master
scripts:
     - TARGET=$(uname -a | cut -d " " -f1) # Sets the OS name (Linux or Darwin)
     - sudo apt-get update
     - git clone https://github.com/pspdev/psptoolchain
     - sudo ./prepare-debian-ubuntu.sh
     - ./toolchain-local.sh
     - tar -cvjf pspdev-$TARGET-TRAVIS_BUILD_NUMBER.tar.gz pspdev
deploy:
  api_key: ${GITHUB_TOKEN}
  file: pspdev-$TARGET-TRAVIS_BUILD_NUMBER.tar.gz
  provider: releases
  skip_cleanup: true
